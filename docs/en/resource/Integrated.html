
<!DOCTYPE HTML>
<html lang="en" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Integrate SDK Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-prism/prism-okaidia.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-anchors/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="User.html" />
    
    
    <link rel="prev" href="Preparation.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="Overview.html">
            
                <a href="Overview.html">
            
                    
                    Function Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="Preparation.html">
            
                <a href="Preparation.html">
            
                    
                    Preparation for integration
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.4" data-path="Integrated.html">
            
                <a href="Integrated.html">
            
                    
                    Integrate SDK
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="User.html">
            
                <a href="User.html">
            
                    
                    User Management
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="User_Sdk_Update.html">
            
                <a href="User_Sdk_Update.html">
            
                    
                    Migration of a Series of SDK Accounts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="User_mobile.html">
            
                <a href="User_mobile.html">
            
                    
                    Use Mobile Phone
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="User_email.html">
            
                <a href="User_email.html">
            
                    
                    Use Email
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="User_uid.html">
            
                <a href="User_uid.html">
            
                    
                    User uid Login System
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="User_Third_Login.html">
            
                <a href="User_Third_Login.html">
            
                    
                    Third Party Login
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.6" data-path="User_Logout.html">
            
                <a href="User_Logout.html">
            
                    
                    Lougout, Disable account
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.7" data-path="User_Data_Model.html">
            
                <a href="User_Data_Model.html">
            
                    
                    Data Model
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" >
            
                <span>
            
                    
                    Home management
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="Home_Manager.html">
            
                <a href="Home_Manager.html">
            
                    
                    Home Management Class
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="Home_Option.html">
            
                <a href="Home_Option.html">
            
                    
                    Operation Class of Home
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.3" data-path="Home_Member.html">
            
                <a href="Home_Member.html">
            
                    
                    Home Member Management Class
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.4" data-path="Room.html">
            
                <a href="Room.html">
            
                    
                    Room information management
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="Activator.html">
            
                <a href="Activator.html">
            
                    
                    Network Configuration
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="Activator_Wifi.html">
            
                <a href="Activator_Wifi.html">
            
                    
                    Wifi Network Configuration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="Activator_Zigbee.html">
            
                <a href="Activator_Zigbee.html">
            
                    
                    ZigBee Gateway Configuration
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="Activator_ZigbeeSub.html">
            
                <a href="Activator_ZigbeeSub.html">
            
                    
                    ZigBee Sub-device Configuration
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" >
            
                <span>
            
                    
                    [Device Control]
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="Device.html">
            
                <a href="Device.html">
            
                    
                    Device Control
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="OTA.html">
            
                <a href="OTA.html">
            
                    
                    Firmware upgrade
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="Device_Data_Channel.html">
            
                <a href="Device_Data_Channel.html">
            
                    
                    Data Model
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="Shared.html">
            
                <a href="Shared.html">
            
                    
                    Shared devices
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="Shared_Device_add.html">
            
                <a href="Shared_Device_add.html">
            
                    
                    Add for Sharing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.2" data-path="Shared_Device_Remove.html">
            
                <a href="Shared_Device_Remove.html">
            
                    
                    Removing Sharing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9.3" data-path="Shared_Device_Rename.html">
            
                <a href="Shared_Device_Rename.html">
            
                    
                    Modifying Remark Name
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="Timer.html">
            
                <a href="Timer.html">
            
                    
                    Timer task
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="Group.html">
            
                <a href="Group.html">
            
                    
                    Group Management
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12" >
            
                <span>
            
                    
                    Smart scene
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.12.1" data-path="SmartScene_Manager.html">
            
                <a href="SmartScene_Manager.html">
            
                    
                    Smart scene
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="Message.html">
            
                <a href="Message.html">
            
                    
                    Message Center
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="Feedback.html">
            
                <a href="Feedback.html">
            
                    
                    Feedback
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="Gateway.html">
            
                <a href="Gateway.html">
            
                    
                    Gateway
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Integrate SDK</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="integrate-sdk"><a name="integrate-sdk" class="plugin-anchor" href="#integrate-sdk"><i class="fa fa-link" aria-hidden="true"></i></a>Integrate SDK</h1>
<h1 id="preparation-for-integration"><a name="preparation-for-integration" class="plugin-anchor" href="#preparation-for-integration"><i class="fa fa-link" aria-hidden="true"></i></a>Preparation for Integration</h1>
<h3 id="1-create-project"><a name="1-create-project" class="plugin-anchor" href="#1-create-project"><i class="fa fa-link" aria-hidden="true"></i></a>(1) Create Project</h3>
<p>Build your project in the Android Studio.</p>
<h3 id="2-introduce-the-aar-package"><a name="2-introduce-the-aar-package" class="plugin-anchor" href="#2-introduce-the-aar-package"><i class="fa fa-link" aria-hidden="true"></i></a>(2) Introduce the aar Package</h3>
<p><img src="images/android_import_aar.jpg" alt="pastedGraphic.png"></p>
<h3 id="3-configure-the-buildgradle"><a name="3-configure-the-buildgradle" class="plugin-anchor" href="#3-configure-the-buildgradle"><i class="fa fa-link" aria-hidden="true"></i></a>(3) Configure the build.gradle</h3>
<p>Add the following codes in the build.gradle file.</p>
<pre class="language-"><code class="lang-groovy">defaultConfig <span class="token punctuation">{</span>
    ndk <span class="token punctuation">{</span>
        abiFilters <span class="token string">&quot;armeabi-v7a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;x86&quot;</span>
    <span class="token punctuation">}</span>

    gradle
    repositories <span class="token punctuation">{</span>
        flatDir <span class="token punctuation">{</span>
            dirs <span class="token string">&apos;libs&apos;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    dependencies <span class="token punctuation">{</span>

        compile <span class="token string">&apos;com.alibaba:fastjson:1.1.67.android&apos;</span>
        compile <span class="token string">&apos;com.squareup.okhttp3:okhttp-urlconnection:3.6.0&apos;</span>

<span class="token comment">// compile &apos;de.greenrobot:eventbus:2.4.0&apos;  Deprecated in 2.7.2</span>

        compile <span class="token string">&apos;io.reactivex.rxjava2:rxandroid:2.0.1&apos;</span>
        compile <span class="token string">&apos;io.reactivex.rxjava2:rxjava:2.1.7&apos;</span>
        compile <span class="token string">&apos;org.eclipse.paho:org.eclipse.paho.client.mqttv3:1.2.0&apos;</span>
<span class="token comment">// compile &apos;org.eclipse.paho:org.eclipse.paho.android.service:1.1.1&apos; Deprecated in 2.7.2</span>
        <span class="token function">compile</span><span class="token punctuation">(</span>name<span class="token punctuation">:</span> <span class="token string">&apos;tuyasmart-x.x.x&apos;</span><span class="token punctuation">,</span> ext<span class="token punctuation">:</span> <span class="token string">&apos;aar&apos;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>


    android <span class="token punctuation">{</span>
        lintOptions <span class="token punctuation">{</span>
            abortOnError <span class="token boolean">false</span>
            disable <span class="token string">&apos;InvalidPackage&apos;</span>
        <span class="token punctuation">}</span>

        compileOptions <span class="token punctuation">{</span>
            sourceCompatibility JavaVersion<span class="token operator">.</span>VERSION_1_7
            targetCompatibility JavaVersion<span class="token operator">.</span>VERSION_1_7
        <span class="token punctuation">}</span>
        packagingOptions <span class="token punctuation">{</span>
            exclude <span class="token string">&apos;META-INF/LICENSE.txt&apos;</span>
            exclude <span class="token string">&apos;META-INF/NOTICE&apos;</span>
            exclude <span class="token string">&apos;META-INF/LICENSE&apos;</span>
            exclude <span class="token string">&apos;META-INF/NOTICE.txt&apos;</span>
            exclude <span class="token string">&apos;META-INF/INDEX.LIST&apos;</span>
            exclude <span class="token string">&apos;META-INF/services/javax.annotation.processing.Processor&apos;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre>
<p><strong>[Note]</strong></p>
<p>The Tuya Smart sdk solely supports the platform of armeabi-v7a and x86 architecture by default. Developer may refer to the <a href="https://github.com/TuyaInc/tuyasmart_android_sdk/tree/master/library" target="_blank">GitHub</a> if you need other platforms. </p>
<h3 id="4-set-the-androidmanifestxml"><a name="4-set-the-androidmanifestxml" class="plugin-anchor" href="#4-set-the-androidmanifestxml"><i class="fa fa-link" aria-hidden="true"></i></a>(4) Set the AndroidManifest.xml</h3>
<p>Set appkey and appSecret in the AndroidManifest.xml file, and configure corresponding permissions, etc.</p>
<pre class="language-"><code class="lang-xml">
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta-data</span>
    <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>TUYA_SMART_APPKEY<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name"><span class="token namespace">android:</span>value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>App id<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta-data</span>
    <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>TUYA_SMART_SECRET<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name"><span class="token namespace">android:</span>value</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>App key<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>

Add essential permission support.

<span class="token comment">&lt;!-- sdcard --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uses-permission</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>android.permission.WRITE_EXTERNAL_STORAGE<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uses-permission</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>android.permission.READ_EXTERNAL_STORAGE<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uses-permission</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>android.permission.READ_PHONE_STATE<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">android:</span>required</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>

<span class="token comment">&lt;!-- Network --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uses-permission</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>android.permission.INTERNET<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uses-permission</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>android.permission.CHANGE_NETWORK_STATE<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uses-permission</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>android.permission.CHANGE_WIFI_STATE<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uses-permission</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>android.permission.ACCESS_NETWORK_STATE<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>uses-permission</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>android.permission.ACCESS_WIFI_STATE<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
&lt;uses-permission android:name=&quot;android.permission.WAKE_LOCK&quot;android:required=&quot;false&quot; /&gt;

Add necessary service and receiver.

//<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>service</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>org.eclipse.paho.android.service.MqttService<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
//from 2.6.3 com.tuya.smart.mqtt.MqttService replace the org.eclipse.paho.android.service.mqttservice
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>service</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>com.tuya.smart.mqtt.MqttService<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">android:</span>stopWithTask</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>receiver</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>com.tuya.smart.android.base.broadcast.NetworkBroadcastReceiver<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>intent-filter</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>action</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>android.net.conn.CONNECTIVITY_CHANGE<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>intent-filter</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>receiver</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>service</span>

<span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>com.tuya.smart.android.hardware.service.GwBroadcastMonitorService<span class="token punctuation">&quot;</span></span>
<span class="token attr-name"><span class="token namespace">android:</span>exported</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>
<span class="token attr-name"><span class="token namespace">android:</span>label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>UDPService<span class="token punctuation">&quot;</span></span>
<span class="token attr-name"><span class="token namespace">android:</span>process</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>:monitor<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>intent-filter</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>action</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>tuya.intent.action.udp<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>


<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>category</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>tuya<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>intent-filter</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>service</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>service</span>
   <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>com.tuya.smart.android.hardware.service.DevTransferService<span class="token punctuation">&quot;</span></span>
   <span class="token attr-name"><span class="token namespace">android:</span>label</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>TCPService<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">&lt;intent-filter</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>action</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>tuya.intent.action.tcp<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
           <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>category</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>tuya<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>intent-filter</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>service</span><span class="token punctuation">&gt;</span></span>
</code></pre>
<h3 id="5-aliasing-configuration"><a name="5-aliasing-configuration" class="plugin-anchor" href="#5-aliasing-configuration"><i class="fa fa-link" aria-hidden="true"></i></a>(5) Aliasing Configuration</h3>
<p>Arrange aliasing configuration in corresponding proguard-rules.pro files. </p>
<pre class="language-"><code class="lang-bash"><span class="token comment">#fastJson</span>
-keep class com.alibaba.fastjson.**<span class="token punctuation">{</span>*<span class="token punctuation">;</span><span class="token punctuation">}</span>
-dontwarn com.alibaba.fastjson.**

<span class="token comment">#netty</span>
-keep class io.netty.** <span class="token punctuation">{</span> *<span class="token punctuation">;</span> <span class="token punctuation">}</span>
-dontwarn io.netty.**

<span class="token comment">#mqtt</span>
-keep class org.eclipse.paho.client.mqttv3.** <span class="token punctuation">{</span> *<span class="token punctuation">;</span> <span class="token punctuation">}</span>
-dontwarn org.eclipse.paho.client.mqttv3.**

-dontwarn okio.**
-dontwarn rx.**
-dontwarn javax.annotation.**
-keep class com.squareup.okhttp.** <span class="token punctuation">{</span> *<span class="token punctuation">;</span> <span class="token punctuation">}</span>
-keep interface com.squareup.okhttp.** <span class="token punctuation">{</span> *<span class="token punctuation">;</span> <span class="token punctuation">}</span>
-keep class okio.** <span class="token punctuation">{</span> *<span class="token punctuation">;</span> <span class="token punctuation">}</span>
-dontwarn com.squareup.okhttp.**

-keep class com.tuya.**<span class="token punctuation">{</span>*<span class="token punctuation">;</span><span class="token punctuation">}</span>
-dontwarn com.tuya.**
</code></pre>
<h2 id="use-the-adk-function-in-codes"><a name="use-the-adk-function-in-codes" class="plugin-anchor" href="#use-the-adk-function-in-codes"><i class="fa fa-link" aria-hidden="true"></i></a>Use the ADK function in codes</h2>
<p>The TuyaHomeSdk is the outbound interface of the Smart Home, and the operations include network configuration, initiation, control, room, group and ZigBee.</p>
<h3 id="1-initiate-tuya-smart-sdk-in-the-application"><a name="1-initiate-tuya-smart-sdk-in-the-application" class="plugin-anchor" href="#1-initiate-tuya-smart-sdk-in-the-application"><i class="fa fa-link" aria-hidden="true"></i></a>(1) Initiate Tuya Smart sdk in the Application</h3>
<p><strong>[Description]</strong></p>
<p>It is used to initiate components of communication services, etc.</p>
<p><strong>[Example Codes]</strong></p>
<pre class="language-"><code class="lang-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TuyaSmartApp</span> <span class="token keyword">extends</span> <span class="token class-name">Application</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        TuyaHomeSdk<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre>
<p><strong>Note:</strong></p>
<p>The appId and appSecret need to be configured in the AndroidManifest.xml file or the build environment or the codes. </p>
<h3 id="2-lou-out-of-the-tuya-smart-cloud-connection"><a name="2-lou-out-of-the-tuya-smart-cloud-connection" class="plugin-anchor" href="#2-lou-out-of-the-tuya-smart-cloud-connection"><i class="fa fa-link" aria-hidden="true"></i></a>(2) Lou out of the Tuya Smart Cloud connection</h3>
<p>The following interface needs to be invoked to log out of the App. </p>
<pre class="language-"><code class="lang-java">TuyaHomeSdk<span class="token punctuation">.</span><span class="token function">onDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="3-monitor-the-invalidity-of-registered-session"><a name="3-monitor-the-invalidity-of-registered-session" class="plugin-anchor" href="#3-monitor-the-invalidity-of-registered-session"><i class="fa fa-link" aria-hidden="true"></i></a>(3) Monitor the invalidity of registered session</h3>
<p><strong>[Description]</strong></p>
<p>Because of abnormality or long-time absence of operation for 45 or more days, the session will become invalid, and user has to log out of the App and log in again to obtain the session. </p>
<p><strong>[Method Invocation]</strong></p>
<pre class="language-"><code class="lang-java"><span class="token comment">// Monitor the invalidity of session.</span>
TuyaHomeSdk<span class="token punctuation">.</span><span class="token function">setOnNeedLoginListener</span><span class="token punctuation">(</span>INeedLoginListener needLoginListener<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p><strong>[Callback]</strong></p>
<pre class="language-"><code class="lang-java">needLoginListener<span class="token punctuation">.</span><span class="token function">onNeedLogin</span><span class="token punctuation">(</span>Context context<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p><strong>[Example Codes]</strong></p>
<pre class="language-"><code class="lang-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TuyaSmartApp</span> <span class="token keyword">extends</span> <span class="token class-name">Application</span> <span class="token punctuation">{</span>

        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// Register in the App.</span>
                TuyaHomeSdk<span class="token punctuation">.</span><span class="token function">setOnNeedLoginListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">INeedLoginListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
               <span class="token annotation punctuation">@Override</span>
                <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onNeedLogin</span><span class="token punctuation">(</span>Context context<span class="token punctuation">)</span> <span class="token punctuation">{</span>

                <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>[<strong>Note</strong>]</p>
<h2 id="-in-case-of-this-kind-of-callback-please-go-to-the-login-page-and-require-the-user-to-log-in-again-"><a name="-in-case-of-this-kind-of-callback-please-go-to-the-login-page-and-require-the-user-to-log-in-again-" class="plugin-anchor" href="#-in-case-of-this-kind-of-callback-please-go-to-the-login-page-and-require-the-user-to-log-in-again-"><i class="fa fa-link" aria-hidden="true"></i></a>- In case of this kind of callback, please go to the login page and require the user to log in again. </h2>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="Preparation.html" class="navigation navigation-prev " aria-label="Previous page: Preparation for integration">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="User.html" class="navigation navigation-next " aria-label="Next page: User Management">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Integrate SDK","level":"1.4","depth":1,"next":{"title":"User Management","level":"1.5","depth":1,"path":"resource/User.md","ref":"./resource/User.md","articles":[{"title":"Migration of a Series of SDK Accounts","level":"1.5.1","depth":2,"path":"resource/User_Sdk_Update.md","ref":"./resource/User_Sdk_Update.md","articles":[]},{"title":"Use Mobile Phone","level":"1.5.2","depth":2,"path":"resource/User_mobile.md","ref":"./resource/User_mobile.md","articles":[]},{"title":"Use Email","level":"1.5.3","depth":2,"path":"resource/User_email.md","ref":"./resource/User_email.md","articles":[]},{"title":"User uid Login System","level":"1.5.4","depth":2,"path":"resource/User_uid.md","ref":"./resource/User_uid.md","articles":[]},{"title":"Third Party Login","level":"1.5.5","depth":2,"path":"resource/User_Third_Login.md","ref":"./resource/User_Third_Login.md","articles":[]},{"title":"Lougout, Disable account","level":"1.5.6","depth":2,"path":"resource/User_Logout.md","ref":"./resource/User_Logout.md","articles":[]},{"title":"Data Model","level":"1.5.7","depth":2,"path":"resource/User_Data_Model.md","ref":"./resource/User_Data_Model.md","articles":[]}]},"previous":{"title":"Preparation for integration","level":"1.3","depth":1,"path":"resource/Preparation.md","ref":"./resource/Preparation.md","articles":[]},"dir":"ltr"},"config":{"plugins":["js-sequence-diagram-full@>=0.3.1","prism","-highlight","anchors"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"prism":{"css":["prismjs/themes/prism-okaidia.css"],"lang":{"java":"java"},"ignore":["sequence"]},"livereload":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"js-sequence-diagram-full":{},"fontsettings":{"theme":"white","family":"sans","size":2},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false},"anchors":{}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"language":"en","gitbook":"*"},"file":{"path":"resource/Integrated.md","mtime":"2018-12-22T07:35:54.498Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2018-12-26T02:11:26.621Z"},"basePath":"..","book":{"language":"en"}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-js-sequence-diagram-full/sequence-diagram-min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-js-sequence-diagram-full/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

